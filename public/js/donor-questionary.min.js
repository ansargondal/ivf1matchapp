$(function () {

    $body = $('body');

    //show warning before user closes the tab
    window.addEventListener("beforeunload", function (e) {
        var confirmationMessage = "\o/";

        (e || window.event).returnValue = confirmationMessage; //Gecko + IE
        return confirmationMessage;                            //Webkit, Safari, Chrome
    });

    $('form input').keydown(function (event) {
        if (event.keyCode == 13) {
            event.preventDefault();
            return false;
        }
    });


    //globally changed error message
    //this field is required  => '*required'
    $.validator.messages.required = '*required';

    $('.date-picker').datepicker();

    // Step show event
    $("#smartwizard").on("showStep", function (e, anchorObject, stepNumber, stepDirection, stepPosition) {
        //alert("You are on step "+stepNumber+" now");
        if (stepPosition === 'first') {
//                   $("#prev-btn").addClass('disabled');
        } else if (stepPosition === 'final') {
            $("#next-btn").addClass('disabled');
        } else {
//                   $("#prev-btn").removeClass('disabled');
            $("#next-btn").removeClass('disabled');
        }
    });

    //datepicker validations  label fixes
    $date.datepicker().on('change', function (e) {
        $(this).parents('.form-group').find('label').addClass('focus');
        $(this).valid();
    });


    // Toolbar extra buttons
    var btnFinish = $('<button></button>').text('Finish')
        .addClass('btn btn-info')
        .on('click', function () {
            alert('Finish Clicked');
        });
    var btnCancel = $('<button></button>').text('Cancel')
        .addClass('btn btn-danger')
        .on('click', function () {
            $('#smartwizard').smartWizard("reset");
        });

    // Please note enabling option "showStepURLhash" will make navigation conflict for multiple wizard in a page.
    // so that option is disabling => showStepURLhash: false

    // Smart Wizard 1
    $('#smartwizard').smartWizard({
        selected: 0,
        theme: 'arrows',
        transitionEffect: 'fade',
        showStepURLhash: false,
        toolbarSettings: {
            toolbarPosition: 'bottom',
            toolbarExtraButtons: [btnFinish, btnCancel]
        }
    });


//region  (STEP 1) Validation Donor Contact
    $('#step1').validate({
        rules: {
            fname: {
                required: true,
                minlength: 2
            },
            lname: {
                required: true,
                minlength: 2
            },
            dob: {
                required: true
            },
            street: {
                required: true
            },
            city: {
                required: true
            },
            state: {
                required: true
            },
            zip: {
                required: true
            }
        },
        messages: {
            fname: {
                required: 'first name is required'
            },
            lname: {
                required: 'last name is required'
            },
            dob: {
                required: "Must be in format MM/DD/YYYY"
            },
            zip: {
                required: 'zip code is required'
            }
        },
    });

    $body.on('click', '#submit1', function (evt) {
        evt.preventDefault();

        var form = $('#step1');

        var isValid = form.valid();

        if (!isValid) {
            return scrollToError();
        } else {
            form.submit();
        }
    });

//endregion

//region  (STEP 1) Donor Contact Information Saving using Ajax Logic
    $('#step1').submit(function (evt) {
        evt.preventDefault();

        var form = $(this);
        var btn = $(this).find('button.donor-submit');

        //if validation fails stop form submission
        var isValid = $(this).valid();
        if (!isValid) return scrollToError();

        showSpiner(btn);

        $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: form.serialize(),
            dataType: "json",
            success: function (response) {

                if (!response.error) {
                    $('#donor_q_next').click();
                    notify(response.message, response.title);
                }
            },
            error: function (response) {

            },
            complete: function () {
                hideSpinner(btn);
            }
        });
    });


    $('#i_starting_from').datepicker();
//endregion

//region (STEP 2) Validation Donor Education
    var form = $('#step2');
    $('#c_c_attending_college').on("click", function (evt) {
        form.valid();
        if ($(this).is(":checked")) {
            $('#i_c_attending_college').rules("add", {
                required: true
            });
        } else {
            $('#i_c_attending_college').rules("remove");
        }
    });
    $('#c_graduate_degree').on("click", function (evt) {
        form.valid();
        if ($(this).is(":checked")) {
            $('#i_graduate_degree').rules("add", {
                required: true
            });
        } else {
            $('#i_graduate_degree').rules("remove");
        }
    });
    $('#c_post_graduate_degree').on("click", function (evt) {

        form.valid();
        if ($(this).is(":checked")) {
            $('#i_post_graduate_degree').rules("add", {
                required: true
            });
        } else {
            $('#i_post_graduate_degree').rules("remove");
        }
    });
    $('#c_degree_other').on("click", function (evt) {
        form.valid();
        if ($(this).is(":checked")) {
            $('#i_degree_other').rules("add", {
                required: true
            });
        } else {
            $('#i_degree_other').rules("remove");
        }
    });

//convert checkbox to radio boxes for high school
    $(".high-school").change(function () {
        $(".high-school").prop('checked', false);
        $(this).prop('checked', true);
        $('#high-school .custom-error').remove();
    });


    /* Disable school checkboxes when college is checked*/
    $body.on('click', '.college', function () {
        //checks if any college checkbox is checked then disable school
        validateCollege();
    });

    $body.on('click', '#submit2', function (evt) {
        evt.preventDefault();

        var form = $('#step2');

        var isValid = form.valid();

        //at least one option should be checked
        if (!validateSchool()) {
            return scrollToError();
        }

        if (!isValid) {
            return scrollToError();
        } else {
            form.submit();
        }
    });

    $body.on('keyup', '#step2 .form-control', function () {
        if ($(this).val().length > 0) {
            $(this).closest('.row').find('input:checkbox').prop('checked', true);

            //checks if any college checkbox is checked then disable school
            validateCollege();
        } else {
            $(this).closest('.row').find('input:checkbox').prop('checked', false);

            //checks if any college checkbox is checked then disable school
            validateCollege();
        }
    });

//endregion

//region (STEP 2)  Donor Education Saving using Ajax
    $('#step2').submit(function (evt) {
        evt.preventDefault();

        var form = $(this);
        var btn = $(this).find('button.donor-submit');


        //if validation fails stop form submission
        var isValid = $(this).valid();
        if (!isValid) return 0;

        showSpiner(btn);

        $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: form.serialize(),
            dataType: "json",
            success: function (response) {
                if (!response.error) {
                    $('#donor_q_next').click();
                    notify(response.message, response.title);
                }
            },
            error: function (response) {

            },
            complete: function () {
                hideSpinner(btn);
            }
        });
    });

//endregion

//region (STEP 3)  Sexual History Information Validation
    $('#step3').validate({
        rules: {
            martial_status: {
                required: true
            },
            living_arrangement: {
                required: true
            },
            partners_1_month: {
                required: true
            },
            partners_6_months: {
                required: true
            },
            partners_5_years: {
                required: true
            },
            orientation: {
                required: true
            },
        },
        messages: {
            martial_status: {
                required: "Martial Status information required."
            },
            living_arrangement: {
                required: "Living arrangement information required."
            },
        },
    });

    //at least one current sexual practice checkbox should be checked on checkbox click
    $body.on('click', '.cb-current-sexual', function () {
        validateCSexualPractice();
    });

    //at least one previous sexual practice checkbox should be checked on checkbox click
    $body.on('click', '.cb-previous-sexual', function () {
        validatePSexualPractice();
    });


    $body.on('click', '#submit3', function (evt) {
        evt.preventDefault();

        var form = $('#step3');

        var isValid = form.valid();

        var cSexualresponse = validateCSexualPractice();
        var pSexualresponse = validatePSexualPractice();

        if (isValid && cSexualresponse === 1 && pSexualresponse === 1) {
            form.submit();
        } else {
            return 0;
        }
    });

//endregion

//region  (STEP 3) Sexual History Information Saving using Ajax Logic

    $('#step3').submit(function (evt) {
        evt.preventDefault();

        var form = $(this);
        var btn = $(this).find('button.donor-submit');

        //if validation fails stop form submission
        var isValid = $(this).valid();
        if (!isValid) return 0;

        showSpiner(btn);

        $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: form.serialize(),
            dataType: "json",
            success: function (response) {
                if (!response.error) {
                    $('#donor_q_next').click();
                    notify(response.message, response.title);
                }
            },
            error: function (response) {

            },
            complete: function () {
                hideSpinner(btn);
            }
        });
    });

//endregion

//region (STEP 4)  Pregnancy Information Validation
    $('#step4').validate({
        rules: {
            pregnancy_history: {
                required: true
            },
            first_period: {
                required: true
            },
            bleeding_begins: {
                required: true
            },
            bleeding_ends: {
                required: true
            },
            bleeding_lasts_from: {
                required: true
            },
            bleeding_lasts_to: {
                required: true
            },
            last_pap_date: {
                required: true
            },
            pills: {
                required: true
            },
            ortho_evra: {
                required: true
            },
            depo_provera: {
                required: true
            },
            norplant: {
                required: true
            },
            iud: {
                required: true
            },
            tubal_ligation: {
                required: true
            },
            condoms: {
                required: true
            },

        },
        messages: {
            martial_status: {
                required: "Pregnancy History required."
            }
            ,
            first_period: {
                required: "First Period information required."
            }
            ,
            last_pap_date: {
                required: "Last PAP required"
            }
            ,
            pills: {
                required: "Oral Contraceptives field required"
            }
            ,
            ortho_evra: {
                required: "Birth Control field required."
            }
            ,
            depo_provera: {
                required: "Progesterone Injections field required."
            }
            ,
            norplant: {
                required: "Progesterone Implants field required."
            }
            ,
            iud: {
                required: "Intrauterine Device field required."
            }
            ,
            tubal_ligation: {
                required: "Sterilization field required."
            }
            ,
            condoms: {
                required: "Condoms field required."
            },

        },
    });

    var form = $('#step4');
    $('#c_did_you_deliver_1').on("click", function (evt) {
        if ($(this).is(":checked")) {
            $('#d_yearofpregnancy_1').prop('name', 'delivery_year[]').rules("add", {
                required: true
            });
            $('#d_boyGirl_1').prop('name', 'baby_gender[]').rules("add", {
                required: true
            });
            $('#i_child_have_prob_1').prop('name', 'baby_problems[]').rules("add", {
                required: true
            });
            $('#i_how_pregnancy_end_1').prop('name', 'pregnancy_end[]').rules("add", {
                required: true
            });
        } else {
            $('#d_yearofpregnancy_1').val('').prop('placeholder', '2000').prop('name', '').rules("remove");
            $('#d_boyGirl_1').val('').prop('placeholder', 'Select').prop('name', '').rules("remove");
            $('#i_child_have_prob_1').val('').prop('name', '').rules("remove");
            $('#i_how_pregnancy_end_1').val('').prop('name', '').rules("remove");
        }
        form.valid();
    });

    $('#c_did_you_deliver_2').on("click", function (evt) {
        if ($(this).is(":checked")) {
            $('#d_yearofpregnancy_2').prop('name', 'delivery_year[]').rules("add", {
                required: true
            });
            $('#d_boyGirl_2').prop('name', 'baby_gender[]').rules("add", {
                required: true
            });
            $('#i_child_have_prob_2').prop('name', 'baby_problems[]').rules("add", {
                required: true
            });
            $('#i_how_pregnancy_end_2').prop('name', 'pregnancy_end[]').rules("add", {
                required: true
            });
        } else {
            $('#d_yearofpregnancy_2').val('').prop('placeholder', '2000').prop('name', '').rules("remove");
            $('#d_boyGirl_2').val('').prop('placeholder', 'Select').prop('name', '').rules("remove");
            $('#i_child_have_prob_2').val('').prop('name', '').rules("remove");
            $('#i_how_pregnancy_end_2').val('').prop('name', '').rules("remove");
        }
        form.valid();
    });
    $('#c_did_you_deliver_3').on("click", function (evt) {
        if ($(this).is(":checked")) {
            $('#d_yearofpregnancy_3').prop('name', 'delivery_year[]').rules("add", {
                required: true
            });
            $('#d_boyGirl_3').prop('name', 'baby_gender[]').rules("add", {
                required: true
            });
            $('#i_child_have_prob_3').prop('name', 'baby_problems[]').rules("add", {
                required: true
            });
            $('#i_how_pregnancy_end_3').prop('name', 'pregnancy_end[]').rules("add", {
                required: true
            });
        } else {
            $('#d_yearofpregnancy_3').val('').prop('placeholder', '2000').prop('name', '').rules("remove");
            $('#d_boyGirl_3').val('').prop('placeholder', 'Select').prop('name', '').rules("remove");
            $('#i_child_have_prob_3').val('').prop('name', '').rules("remove");
            $('#i_how_pregnancy_end_3').val('').prop('name', '').rules("remove");
        }
        form.valid();
    });
    $('#c_did_you_deliver_4').on("click", function (evt) {
        if ($(this).is(":checked")) {
            $('#d_yearofpregnancy_4').prop('name', 'delivery_year[]').rules("add", {
                required: true
            });
            $('#d_boyGirl_4').prop('name', 'baby_gender[]').rules("add", {
                required: true
            });
            $('#i_child_have_prob_4').prop('name', 'baby_problems[]').rules("add", {
                required: true
            });
            $('#i_how_pregnancy_end_4').prop('name', 'pregnancy_end[]').rules("add", {
                required: true
            });
        } else {
            $('#d_yearofpregnancy_4').val('').prop('placeholder', '2000').prop('name', '').rules("remove");
            $('#d_boyGirl_4').val('').prop('placeholder', 'Select').prop('name', '').rules("remove");
            $('#i_child_have_prob_4').val('').prop('name', '').rules("remove");
            $('#i_how_pregnancy_end_4').val('').prop('name', '').rules("remove");
        }
        form.valid();
    });
    $body.on('click', '#submit4', function (evt) {
        evt.preventDefault();

        var form = $('#step4');

        var isValid = form.valid();

        if (!isValid) {
            return 0;
        } else {
            form.submit();
        }
    });

//endregion

//region  (STEP 4) Pregnancy Information Saving using Ajax Logic

    $('#step4').submit(function (evt) {
        evt.preventDefault();

        var form = $(this);
        var btn = $(this).find('button.donor-submit');

        //if validation fails stop form submission
        var isValid = $(this).valid();
        if (!isValid) return 0;

        showSpiner(btn);

        $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: form.serialize(),
            dataType: "json",
            success: function (response) {
                if (!response.error) {
                    $('#donor_q_next').click();
                    notify(response.message, response.title);
                }
            },
            error: function (response) {

            },
            complete: function () {
                hideSpinner(btn);
            }
        });
    });

//endregion

//region (STEP 5) Lifestyle Information Validation
    validator = $('#step5').validate({
        rules: {
            exercise_routine: {
                required: true
            },
            exercise_type: {
                required: true
            },

            diet_type: {
                required: true
            },
            diet_quality: {
                required: true
            },
            tobacco: {
                required: true
            },
            alcohol: {
                required: true
            },
            marijuana: {
                required: true
            },
            heroin: {
                required: true
            },
            cocaine: {
                required: true
            },
            meth: {
                required: true
            },
            lsd: {
                required: true
            },
            pcp: {
                required: true
            },
            injectable_drug: {
                required: true
            }
        },
        messages: {
            exercise_routine: {
                required: "Exercise field required."
            },
        },
        exercise_type: {
            required: "Exercise Type field required."
        },
        diet_type: {
            required: "Diet field required."
        },
        diet_quality: {
            required: "Quality Diet field required."
        },
    });

    $body.on("change", "#d_cigarettesTabacco", function () {
        if ($(this).val() !== "Never") {
            $('#i_cigarettesTobacco').rules("add", {
                required: true
            });
        } else {
            $('#i_cigarettesTobacco').rules("remove");
        }
    });

    $body.on("change", "#d_alcohol", function () {
        if ($(this).val() !== "Never") {
            $('#i_alcohol').rules("add", {
                required: true
            });
        } else {
            $('#i_alcohol').rules("remove");
        }
    });

    $body.on("change", "#d_marijuana", function () {
        if ($(this).val() !== "Never") {
            $('#i_marijuana').rules("add", {
                required: true
            });
        } else {
            $('#i_marijuana').rules("remove");
        }
    });

    $body.on("change", "#d_heroin", function () {
        if ($(this).val() !== "Never") {
            $('#i_heroin').rules("add", {
                required: true
            });
        } else {
            $('#i_heroin').rules("remove");
        }
    });

    $body.on("change", "#d_heroin", function () {
        if ($(this).val() !== "Never") {
            $('#i_heroin').rules("add", {
                required: true
            });
        } else {
            $('#i_heroin').rules("remove");
        }
    });

    $('#c_arrested').on("click", function (evt) {
        if ($(this).is(":checked")) {
            $('#i_arrested').rules("add", {
                required: true
            });
        } else {
            $('#i_arrested').rules("remove");
        }
    });

    $('#c_convicted').on("click", function (evt) {
        if ($(this).is(":checked")) {
            $('#i_convicted').rules("add", {
                required: true
            });
        } else {
            $('#i_convicted').rules("remove");
        }
    });

    var form = $('#step5');

    $('#d_n_used_1').datepicker();

    $('#s_n_used_1').on("click", function (evt) {
        if ($(this).is(":checked")) {
            $('#d_n_used_1').prop('name', 'tattoo_date[]').rules("add", {
                required: true
            });
            $('#t_n_used_1').prop('name', 'tattoo[]').rules("add", {
                required: true
            });
            $('#i_n_used_1').prop('name', 'tattoo_location[]').rules("add", {
                required: true
            });
        } else {
            $('#d_n_used_1').val('').prop('placeholder', 'Date').prop('name', '').rules("remove");
            $('#t_n_used_1').val('').prop('placeholder', 'Select').prop('name', '').rules("remove");
            $('#i_n_used_1').val('').prop('name', '').rules("remove");
        }

        form.valid();
    });

    $('#s_n_used_2').on("click", function (evt) {
        if ($(this).is(":checked")) {
            $('#d_n_used_2').prop('name', 'tattoo_date[]').rules("add", {
                required: true
            });
            $('#t_n_used_2').prop('name', 'tattoo[]').rules("add", {
                required: true
            });
            $('#i_n_used_2').prop('name', 'tattoo_location[]').rules("add", {
                required: true
            });
        } else {
            $('#d_n_used_2').val('').prop('placeholder', 'Date').prop('name', '').rules("remove");
            $('#t_n_used_2').val('').prop('placeholder', 'Select').prop('name', '').rules("remove");
            $('#i_n_used_2').val('').prop('name', '').rules("remove");
        }
        form.valid();
    });

    $('#s_n_used_3').on("click", function (evt) {
        if ($(this).is(":checked")) {
            $('#d_n_used_3').prop('name', 'tattoo_date[]').rules("add", {
                required: true
            });
            $('#t_n_used_3').prop('name', 'tattoo[]').rules("add", {
                required: true
            });
            $('#i_n_used_3').prop('name', 'tattoo_location[]').rules("add", {
                required: true
            });
        } else {
            $('#d_n_used_3').val('').prop('placeholder', 'Date').prop('name', '').rules("remove");
            $('#t_n_used_3').val('').prop('placeholder', 'Select').prop('name', '').rules("remove");
            $('#i_n_used_3').val('').prop('name', '').rules("remove");
        }
        form.valid();
    });

    $('#s_n_used_4').on("click", function (evt) {
        if ($(this).is(":checked")) {
            $('#d_n_used_4').prop('name', 'tattoo_date[]').rules("add", {
                required: true
            });
            $('#t_n_used_4').prop('name', 'tattoo[]').rules("add", {
                required: true
            });
            $('#i_n_used_4').prop('name', 'tattoo_location[]').rules("add", {
                required: true
            });
        } else {
            $('#d_n_used_4').val('').prop('placeholder', 'Date').prop('name', '').rules("remove");
            $('#t_n_used_4').val('').prop('placeholder', 'Select').prop('name', '').rules("remove");
            $('#i_n_used_4').val('').prop('name', '').rules("remove");
        }
        form.valid();
    });

    $('#s_n_used_5').on("click", function (evt) {
        if ($(this).is(":checked")) {
            $('#d_n_used_5').prop('name', 'tattoo_date[]').rules("add", {
                required: true
            });
            $('#t_n_used_5').prop('name', 'tattoo[]').rules("add", {
                required: true
            });
            $('#i_n_used_5').prop('name', 'tattoo_location[]').rules("add", {
                required: true
            });
        } else {
            $('#d_n_used_5').val('').prop('placeholder', 'Date').prop('name', '').rules("remove");
            $('#t_n_used_5').val('').prop('placeholder', 'Select').prop('name', '').rules("remove");
            $('#i_n_used_5').val('').prop('name', '').rules("remove");
        }
        form.valid();
    });


    $body.on('click', '#submit5', function (evt) {
        evt.preventDefault();

        var form = $('#step5');

        var isValid = form.valid();

        if (!isValid) {
            return 0;
        } else {
            form.submit();
        }
    });

//endregion

//region  (STEP 5) Lifestyle Information Saving using Ajax Logic
    $('#step5').submit(function (evt) {
        evt.preventDefault();

        var form = $(this);
        var btn = $(this).find('button.donor-submit');

        //if validation fails stop form submission
        var isValid = $(this).valid();
        if (!isValid) return 0;

        showSpiner(btn);

        $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: form.serialize(),
            dataType: "json",
            success: function (response) {
                if (!response.error) {
                    $('#donor_q_next').click();
                    notify(response.message, response.title);
                }
            },
            error: function (response) {

            },
            complete: function () {
                hideSpinner(btn);
            }
        });
    });

//endregion

//region (STEP 6)  Medical History Questions step 1 Information Validation
    var form = $('#step6');
    $('#c_blood_transfusion').on("click", function (evt) {
        form.valid();
        if ($(this).is(":checked")) {
            $('#i_blood_transfusion').rules("add", {
                required: true
            });

            form.valid();
        } else {
            $('#i_blood_transfusion').rules("remove");
            form.valid();
        }
    });

    $('#c_blood_donor').on("click", function (evt) {
        form.valid();
        if ($(this).is(":checked")) {
            $('#i_blood_donor').rules("add", {
                required: true
            });
            form.valid();
        } else {
            $('#i_blood_donor').rules("remove");
            form.valid();
        }
    });

    $body.on('click', '#submit6', function (evt) {
        evt.preventDefault();

        var form = $('#step6');

        var isValid = form.valid();

        if (!isValid) {
            return 0;
        } else {
            form.submit();
        }
    });

//endregion

//region  (STEP 6) Medical History Questions Step 1 Information Saving using Ajax Logic
    $('#step6').submit(function (evt) {
        evt.preventDefault();

        var form = $(this);
        var btn = $(this).find('button.donor-submit');

        //if validation fails stop form submission
        var isValid = $(this).valid();
        if (!isValid) return 0;

        showSpiner(btn);

        $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: form.serialize(),
            dataType: "json",
            success: function (response) {
                if (!response.error) {
                    $('#donor_q_next').click();
                    notify(response.message, response.title);
                }
            },
            error: function (response) {
            },
            complete: function () {
                hideSpinner(btn);
            }
        });
    });

//endregion

//region (STEP 7) Medical History Step 2 Information Validation
    $('#step7').validate({
        rules: {
            vaccinated: {
                required: true
            }
        },
        messages: {
            vaccinated_for: {
                required: "Answer to this question is required."
            }
        },
    });

    var form = $('#step7');
    $body.on("change", "#d_have_vaccinated", function () {
        form.valid();
        if ($(this).val() !== "No") {
            $('#i_have_vaccinated').rules("add", {
                required: true
            });
            form.valid();
        } else {
            $('#i_have_vaccinated').rules("remove");
            form.valid();
        }
    });

    $body.on("change", "#i_medical_prob_1", function () {
        if ($(this).val() !== "") {
            $('#i_age_onset_1').rules("add", {
                required: true
            });
            $('#i_medical_comment_1').rules("add", {
                required: true
            });
        } else {
            $('#i_age_onset_1').rules("remove");
            $('#i_medical_comment_1').rules("remove");
        }
    });

    $body.on("change", "#i_medical_prob_2", function () {
        if ($(this).val() !== "") {
            $('#i_age_onset_2').rules("add", {
                required: true
            });
            $('#i_medical_comment_2').rules("add", {
                required: true
            });
        } else {
            $('#i_age_onset_2').rules("remove");
            $('#i_medical_comment_2').rules("remove");
        }
    });
    $body.on("change", "#i_medical_prob_3", function () {
        if ($(this).val() !== "") {
            $('#i_age_onset_3').rules("add", {
                required: true
            });
            $('#i_medical_comment_3').rules("add", {
                required: true
            });
        } else {
            $('#i_age_onset_3').rules("remove");
            $('#i_medical_comment_3').rules("remove");
        }
    });
    $body.on("change", "#i_medical_prob_4", function () {
        if ($(this).val() !== "") {
            $('#i_age_onset_4').rules("add", {
                required: true
            });
            $('#i_medical_comment_4').rules("add", {
                required: true
            });
        } else {
            $('#i_age_onset_4').rules("remove");
            $('#i_medical_comment_4').rules("remove");
        }
    });
    $body.on("change", "#i_medical_prob_5", function () {
        if ($(this).val() !== "") {
            $('#i_age_onset_5').rules("add", {
                required: true
            });
            $('#i_medical_comment_5').rules("add", {
                required: true
            });
        } else {
            $('#i_age_onset_5').rules("remove");
            $('#i_medical_comment_5').rules("remove");
        }
    });

    $body.on("change", "#i_type_surgery_1", function () {
        if ($(this).val() !== "") {
            $('#i_surgery_date_1').rules("add", {
                required: true
            });
            $('#i_surgery_complication_1').rules("add", {
                required: true
            });
        } else {
            $('#i_surgery_date_1').rules("remove");
            $('#i_surgery_complication_1').rules("remove");
        }
    });
    $body.on("change", "#i_type_surgery_2", function () {
        if ($(this).val() !== "") {
            $('#i_surgery_date_2').rules("add", {
                required: true
            });
            $('#i_surgery_complication_2').rules("add", {
                required: true
            });
        } else {
            $('#i_surgery_date_2').rules("remove");
            $('#i_surgery_complication_2').rules("remove");
        }
    });
    $body.on("change", "#i_type_surgery_3", function () {
        if ($(this).val() !== "") {
            $('#i_surgery_date_3').rules("add", {
                required: true
            });
            $('#i_surgery_complication_3').rules("add", {
                required: true
            });
        } else {
            $('#i_surgery_date_3').rules("remove");
            $('#i_surgery_complication_3').rules("remove");
        }
    });
    $body.on("change", "#i_type_surgery_4", function () {
        if ($(this).val() !== "") {
            $('#i_surgery_date_4').rules("add", {
                required: true
            });
            $('#i_surgery_complication_4').rules("add", {
                required: true
            });
        } else {
            $('#i_surgery_date_4').rules("remove");
            $('#i_surgery_complication_4').rules("remove");
        }
    });
    $body.on("change", "#i_type_surgery_5", function () {
        if ($(this).val() !== "") {
            $('#i_surgery_date_5').rules("add", {
                required: true
            });
            $('#i_surgery_complication_5').rules("add", {
                required: true
            });
        } else {
            $('#i_surgery_date_5').rules("remove");
            $('#i_surgery_complication_5').rules("remove");
        }
    });

    $body.on("change", "#i_p_medication_1", function () {
        if ($(this).val() !== "") {
            $('#i_p_how_often_1').rules("add", {
                required: true
            });
            $('#i_p_medication_reason_1').rules("add", {
                required: true
            });
        } else {
            $('#i_p_how_often_1').rules("remove");
            $('#i_p_medication_reason_1').rules("remove");
        }
    });
    $body.on("change", "#i_p_medication_2", function () {
        if ($(this).val() !== "") {
            $('#i_p_how_often_2').rules("add", {
                required: true
            });
            $('#i_p_medication_reason_2').rules("add", {
                required: true
            });
        } else {
            $('#i_p_how_often_2').rules("remove");
            $('#i_p_medication_reason_2').rules("remove");
        }
    });
    $body.on("change", "#i_p_medication_3", function () {
        if ($(this).val() !== "") {
            $('#i_p_how_often_3').rules("add", {
                required: true
            });
            $('#i_p_medication_reason_3').rules("add", {
                required: true
            });
        } else {
            $('#i_p_how_often_3').rules("remove");
            $('#i_p_medication_reason_3').rules("remove");
        }
    });
    $body.on("change", "#i_p_medication_4", function () {
        if ($(this).val() !== "") {
            $('#i_p_how_often_4').rules("add", {
                required: true
            });
            $('#i_p_medication_reason_4').rules("add", {
                required: true
            });
        } else {
            $('#i_p_how_often_4').rules("remove");
            $('#i_p_medication_reason_4').rules("remove");
        }
    });
    $body.on("change", "#i_p_medication_5", function () {
        if ($(this).val() !== "") {
            $('#i_p_how_often_5').rules("add", {
                required: true
            });
            $('#i_p_medication_reason_5').rules("add", {
                required: true
            });
        } else {
            $('#i_p_how_often_5').rules("remove");
            $('#i_p_medication_reason_5').rules("remove");
        }
    });

    $body.on("change", "#i_c_medication_1", function () {
        if ($(this).val() !== "") {
            $('#i_c_how_often_1').rules("add", {
                required: true
            });
            $('#i_c_medication_reason_1').rules("add", {
                required: true
            });
        } else {
            $('#i_c_how_often_1').rules("remove");
            $('#i_c_medication_reason_1').rules("remove");
        }
    });
    $body.on("change", "#i_c_medication_2", function () {
        if ($(this).val() !== "") {
            $('#i_c_how_often_2').rules("add", {
                required: true
            });
            $('#i_c_medication_reason_2').rules("add", {
                required: true
            });
        } else {
            $('#i_c_how_often_2').rules("remove");
            $('#i_c_medication_reason_2').rules("remove");
        }
    });
    $body.on("change", "#i_c_medication_3", function () {
        if ($(this).val() !== "") {
            $('#i_c_how_often_3').rules("add", {
                required: true
            });
            $('#i_c_medication_reason_3').rules("add", {
                required: true
            });
        } else {
            $('#i_c_how_often_3').rules("remove");
            $('#i_c_medication_reason_3').rules("remove");
        }
    });
    $body.on("change", "#i_c_medication_4", function () {
        if ($(this).val() !== "") {
            $('#i_c_how_often_4').rules("add", {
                required: true
            });
            $('#i_c_medication_reason_4').rules("add", {
                required: true
            });
        } else {
            $('#i_c_how_often_4').rules("remove");
            $('#i_c_medication_reason_4').rules("remove");
        }
    });
    $body.on("change", "#i_c_medication_5", function () {
        if ($(this).val() !== "") {
            $('#i_c_how_often_5').rules("add", {
                required: true
            });
            $('#i_c_medication_reason_5').rules("add", {
                required: true
            });
        } else {
            $('#i_c_how_often_5').rules("remove");
            $('#i_c_medication_reason_5').rules("remove");
        }
    });

    $body.on("change", "#i_substance_1", function () {
        if ($(this).val() !== "") {
            $('#i_type_reaction_1').rules("add", {
                required: true
            });
        } else {
            $('#i_type_reaction_1').rules("remove");
        }
    });
    $body.on("change", "#i_substance_2", function () {
        if ($(this).val() !== "") {
            $('#i_type_reaction_2').rules("add", {
                required: true
            });
        } else {
            $('#i_type_reaction_2').rules("remove");
        }
    });
    $body.on("change", "#i_substance_3", function () {
        if ($(this).val() !== "") {
            $('#i_type_reaction_3').rules("add", {
                required: true
            });
        } else {
            $('#i_type_reaction_3').rules("remove");
        }
    });
    $body.on("change", "#i_substance_4", function () {
        if ($(this).val() !== "") {
            $('#i_type_reaction_4').rules("add", {
                required: true
            });
        } else {
            $('#i_type_reaction_4').rules("remove");
        }
    });
    $body.on("change", "#i_substance_5", function () {
        if ($(this).val() !== "") {
            $('#i_type_reaction_5').rules("add", {
                required: true
            });
        } else {
            $('#i_type_reaction_5').rules("remove");
        }
    });
    $('body').on('click', '#submit7', function (evt) {
        evt.preventDefault();

        var form = $('#step7');

        var isValid = form.valid();

        if (!isValid) {
            return 0;
        } else {
            form.submit();
        }
    });

//endregion

//region (STEP 7) Medical History Step 2 Information saving using Ajax Logic
    $('#step7').submit(function (evt) {
        evt.preventDefault();

        var form = $(this);
        var btn = $(this).find('button.donor-submit');

        //if validation fails stop form submission
        var isValid = $(this).valid();
        if (!isValid) return 0;

        showSpiner(btn);

        $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: form.serialize(),
            dataType: "json",
            success: function (response) {
                if (!response.error) {
                    $('#donor_q_next').click();
                    notify(response.message, response.title);
                } else {
                    notify(response.message, response.title);
                }
            },
            error: function (response) {

            },
            complete: function () {
                hideSpinner(btn);
            }
        });
    });
//endregion

//region (STEP 8) Medical History Step 3 Information Validation
    $('#step8').validate({
        rules: {
            cleft_lip: {
                required: true
            },
            cleft_lip_family: {
                required: true
            },
            cleft_palate: {
                required: true
            },
            cleft_palate_family: {
                required: true
            },
            hip_dislocation: {
                required: true
            },
            hip_dislocation_family: {
                required: true
            },
            clubfoot: {
                required: true
            },
            clubfoot_family: {
                required: true
            },
            heart_defect: {
                required: true
            },
            heart_defect_family: {
                required: true
            },
            hearing_issue: {
                required: true
            },
            hearing_issue_family: {
                required: true
            },
            spina_bifida: {
                required: true
            },
            spina_bifida_family: {
                required: true
            },
            microcephaly: {
                required: true
            },
            microcephaly_family: {
                required: true
            },
            holoprosencephaly: {
                required: true
            },
            holoprosencephaly_family: {
                required: true
            },
            death_at_birth: {
                required: true
            },
            death_at_birth_family: {
                required: true
            },
            dwarfism: {
                required: true
            },
            dwarfism_family: {
                required: true
            },
            hypospadias: {
                required: true
            },
            hypospadias_family: {
                required: true
            },
            pheny: {
                required: true
            },
            pheny_family: {
                required: true
            },
            polycystic: {
                required: true
            },
            polycystic_family: {
                required: true
            },
            pyloric: {
                required: true
            },
            pyloric_family: {
                required: true
            },
            other_congenital: {
                required: true
            },
            other_congenital_family: {
                required: true
            },

            //chromosomal abnormalities
            downs: {
                required: true
            },
            downs_family: {
                required: true
            },
            fragile_x: {
                required: true
            },
            fragile_x_family: {
                required: true
            },
            turner: {
                required: true
            },
            turner_family: {
                required: true
            },
            klinefelter: {
                required: true
            },
            klinefelter_family: {
                required: true
            },
            other_abnormality: {
                required: true
            },
            other_abnormality_family: {
                required: true
            },


            //genetic abnormalities
            alpha_1: {
                required: true
            },
            alpha_1_family: {
                required: true
            },
            bloom: {
                required: true
            },
            bloom_family: {
                required: true
            },
            canavan: {
                required: true
            },
            canavan_family: {
                required: true
            },
            cystic_fibrosis: {
                required: true
            },
            cystic_fibrosis_family: {
                required: true
            },
            fabry: {
                required: true
            },
            fabry_family: {
                required: true
            },
            factor_v: {
                required: true
            },
            factor_v_family: {
                required: true
            },
            familial_dis: {
                required: true
            },
            familial_dis_family: {
                required: true
            },
            familial_med: {
                required: true
            },
            familial_med_family: {
                required: true
            },
            fanconi: {
                required: true
            },
            fanconi_family: {
                required: true
            },
            hemophilia: {
                required: true
            },
            hemophilia_family: {
                required: true
            },
            marfan: {
                required: true
            },
            marfan_family: {
                required: true
            },
            mucolipidosis4: {
                required: true
            },
            mucolipidosis4_family: {
                required: true
            },
            niemann_pick: {
                required: true
            },
            niemann_pick_family: {
                required: true
            },
            sickle_cell: {
                required: true
            },
            sickle_cell_family: {
                required: true
            },
            tay_sachs: {
                required: true
            },
            tay_sachs_family: {
                required: true
            },
            thallasemia: {
                required: true
            },
            thallasemia_family: {
                required: true
            },
            blindness: {
                required: true
            },
            blindness_family: {
                required: true
            },
            color_blind: {
                required: true
            },
            color_blind_family: {
                required: true
            },
            deafness: {
                required: true
            },
            deafness_family: {
                required: true
            },
            albinism: {
                required: true
            },
            albinism_family: {
                required: true
            },
            muscular_dystrophy: {
                required: true
            },
            muscular_dystrophy_family: {
                required: true
            },
            galactosemia: {
                required: true
            },
            galactosemia_family: {
                required: true
            },
            hurlers: {
                required: true
            },
            hurlers_family: {
                required: true
            },
            other_genetic: {
                required: true
            },
            other_genetic_family: {
                required: true
            },

            //cancer abnormalities
            breast: {
                required: true
            },
            breast_family: {
                required: true
            },
            colon: {
                required: true
            },
            colon_family: {
                required: true
            },
            hnpcc: {
                required: true
            },
            hnpcc_family: {
                required: true
            },
            ovarian: {
                required: true
            },
            ovarian_family: {
                required: true
            },
            other_cancer: {
                required: true
            },
            other_cancer_family: {
                required: true
            },

            //neurologic abnormalities
            alzhemers: {
                required: true
            },
            alzhemers_family: {
                required: true
            },
            autism: {
                required: true
            },
            autism_family: {
                required: true
            },

            cerebral_palsy: {
                required: true
            },
            cerebral_palsy_family: {
                required: true
            },
            creultzfeldt: {
                required: true
            },
            creultzfeldt_family: {
                required: true
            },
            depression: {
                required: true
            },
            depression_family: {
                required: true
            },
            gauchers: {
                required: true
            }, gauchers_family: {
                required: true
            },
            huntingtons: {
                required: true
            },
            huntingtons_family: {
                required: true
            },
            hydrocephalus: {
                required: true
            },
            hydrocephalus_family: {
                required: true
            },
            obsessive: {
                required: true
            }, obsessive_family: {
                required: true
            },
            mania: {
                required: true
            },
            mania_family: {
                required: true
            },
            retardation: {
                required: true
            },
            retardation_family: {
                required: true
            },

            neurofibromatosis: {
                required: true
            },
            neurofibromatosis_family: {
                required: true
            },
            schizophrenia: {
                required: true
            },
            schizophrenia_family: {
                required: true
            },
            tourette: {
                required: true
            },
            tourette_family: {
                required: true
            },
            tuberous: {
                required: true
            },
            tuberous_family: {
                required: true
            },
            wilsons: {
                required: true
            }, wilsons_family: {
                required: true
            },
            multiple_sclerosis: {
                required: true
            }, multiple_sclerosis_family: {
                required: true
            },
            parkinsons: {
                required: true
            }, parkinsons_family: {
                required: true
            },
            lougehrigs: {
                required: true
            }, lougehrigs_family: {
                required: true
            },
            other_neurologic: {
                required: true
            },
            other_neurologic_family: {
                required: true
            },
            diabetes: {
                required: true
            }, diabetes_family: {
                required: true
            },
            heart_disease: {
                required: true
            },
            heart_disease_family: {
                required: true
            },
            high_bp: {
                required: true
            },
            high_bp_family: {
                required: true
            },
            asthma: {
                required: true
            },
            asthma_family: {
                required: true
            },
            lupus: {
                required: true
            },
            lupus_family: {
                required: true
            },
            obesity: {
                required: true
            },
            obesity_family: {
                required: true
            },

            alcoholism: {
                required: true
            }, alcoholism_family: {
                required: true
            },

            infertility: {
                required: true
            }, infertility_family: {
                required: true
            },

            miscarriage: {
                required: true
            }, miscarriage_family: {
                required: true
            },
            endometriosis: {
                required: true
            },
            endometriosis_family: {
                required: true
            },

            polycystic_ovary: {
                required: true
            },
            polycystic_ovary_family: {
                required: true
            },
            uterine_fibroids: {
                required: true
            },
            uterine_fibroids_family: {
                required: true
            }
        },
    });

    $body.on("change", "#d_cleftlip, #d_f_cleftlip", function () {
        if ($(this).val() !== "No") {
            $('#i_cleftlip').rules("add", {
                required: true
            });
        } else {
            $('#i_cleftlip').rules("remove");
        }
    });
    $body.on("change", "#d_cleftpalate, #d_f_cleftpalate", function () {
        if ($(this).val() !== "No") {
            $('#i_cleftpalate').rules("add", {
                required: true
            });
        } else {
            $('#i_cleftpalate').rules("remove");
        }
    });
    $body.on("change", "#d_congenitalhip, #d_f_congenitalhip", function () {
        if ($(this).val() !== "No") {
            $('#i_congenitalhip').rules("add", {
                required: true
            });
        } else {
            $('#i_congenitalhip').rules("remove");
        }
    });
    $body.on("change", "#d_clubfoot, #d_f_clubfoot", function () {
        if ($(this).val() !== "No") {
            $('#i_clubfoot').rules("add", {
                required: true
            });
        } else {
            $('#i_clubfoot').rules("remove");
        }
    });
    $body.on("change", "#d_heartdefect, #d_f_heartdefect", function () {
        if ($(this).val() !== "No") {
            $('#i_heartdefect').rules("add", {
                required: true
            });
        } else {
            $('#i_heartdefect').rules("remove");
        }
    });
    $body.on("change", "#d_hearingproblems, #d_f_hearingproblems", function () {
        if ($(this).val() !== "No") {
            $('#i_hearingproblems').rules("add", {
                required: true
            });
        } else {
            $('#i_hearingproblems').rules("remove");
        }
    });
    $body.on("change", "#d_spina, #d_f_spina", function () {
        if ($(this).val() !== "No") {
            $('#i_spina').rules("add", {
                required: true
            });
        } else {
            $('#i_spina').rules("remove");
        }
    });
    $body.on("change", "#d_microcephaly, #d_f_microcephaly", function () {
        if ($(this).val() !== "No") {
            $('#i_microcephaly').rules("add", {
                required: true
            });
        } else {
            $('#i_microcephaly').rules("remove");
        }
    });
    $body.on("change", "#d_holoprosencephaly, #d_f_holoprosencephaly", function () {
        if ($(this).val() !== "No") {
            $('#i_holoprosencephaly').rules("add", {
                required: true
            });
        } else {
            $('#i_holoprosencephaly').rules("remove");
        }
    });
    $body.on("change", "#d_babiesdiedatbirth, #d_f_babiesdiedatbirth", function () {
        if ($(this).val() !== "No") {
            $('#i_babiesdiedatbirth').rules("add", {
                required: true
            });
        } else {
            $('#i_babiesdiedatbirth').rules("remove");
        }
    });
    $body.on("change", "#d_dwarfism, #d_f_dwarfism", function () {
        if ($(this).val() !== "No") {
            $('#i_dwarfism').rules("add", {
                required: true
            });
        } else {
            $('#i_dwarfism').rules("remove");
        }
    });
    $body.on("change", "#d_hypospadias, #d_f_hypospadias", function () {
        if ($(this).val() !== "No") {
            $('#i_hypospadias').rules("add", {
                required: true
            });
        } else {
            $('#i_hypospadias').rules("remove");
        }
    });
    $body.on("change", "#d_phenylketonuria, #d_f_phenylketonuria", function () {
        if ($(this).val() !== "No") {
            $('#i_phenylketonuria').rules("add", {
                required: true
            });
        } else {
            $('#i_phenylketonuria').rules("remove");
        }
    });
    $body.on("change", "#d_polycystickidney, #d_f_polycystickidney", function () {
        if ($(this).val() !== "No") {
            $('#i_polycystickidney').rules("add", {
                required: true
            });
        } else {
            $('#i_polycystickidney').rules("remove");
        }
    });
    $body.on("change", "#d_pyloricstenosis, #d_f_pyloricstenosis", function () {
        if ($(this).val() !== "No") {
            $('#i_pyloricstenosis').rules("add", {
                required: true
            });
        } else {
            $('#i_pyloricstenosis').rules("remove");
        }
    });
    $body.on("change", "#d_othercogenital, #d_f_othercogenital", function () {
        if ($(this).val() !== "No") {
            $('#i_othercogenital').rules("add", {
                required: true
            });
        } else {
            $('#i_othercogenital').rules("remove");
        }
    });
    $body.on("change", "#d_downsyndrome, #d_f_downsyndrome", function () {
        if ($(this).val() !== "No") {
            $('#i_downsyndrome').rules("add", {
                required: true
            });
        } else {
            $('#i_downsyndrome').rules("remove");
        }
    });
    $body.on("change", "#d_fragilex, #d_f_fragilex", function () {
        if ($(this).val() !== "No") {
            $('#i_fragilex').rules("add", {
                required: true
            });
        } else {
            $('#i_fragilex').rules("remove");
        }
    });
    $body.on("change", "#d_turnursyndrom, #d_f_turnursyndrom", function () {
        if ($(this).val() !== "No") {
            $('#i_turnursyndrom').rules("add", {
                required: true
            });
        } else {
            $('#i_turnursyndrom').rules("remove");
        }
    });
    $body.on("change", "#d_klinefelter, #d_f_klinefelter", function () {
        if ($(this).val() !== "No") {
            $('#i_klinefelter').rules("add", {
                required: true
            });
        } else {
            $('#i_klinefelter').rules("remove");
        }
    });
    $body.on("change", "#d_otherchromosomal, #d_f_otherchromosomal", function () {
        if ($(this).val() !== "No") {
            $('#i_otherchromosomal').rules("add", {
                required: true
            });
        } else {
            $('#i_otherchromosomal').rules("remove");
        }
    });
    $body.on("change", "#d_alpha_1, #d_f_alpha_1", function () {
        if ($(this).val() !== "No") {
            $('#i_alpha_1').rules("add", {
                required: true
            });
        } else {
            $('#i_alpha_1').rules("remove");
        }
    });
    $body.on("change", "#d_bloom, #d_f_bloom", function () {
        if ($(this).val() !== "No") {
            $('#i_bloom').rules("add", {
                required: true
            });
        } else {
            $('#i_bloom').rules("remove");
        }
    });
    $body.on("change", "#d_canavan, #d_f_canavan", function () {
        if ($(this).val() !== "No") {
            $('#i_canavan').rules("add", {
                required: true
            });
        } else {
            $('#i_canavan').rules("remove");
        }
    });
    $body.on("change", "#d_cysticfibroses, #d_f_cysticfibroses", function () {
        if ($(this).val() !== "No") {
            $('#i_cysticfibroses').rules("add", {
                required: true
            });
        } else {
            $('#i_cysticfibroses').rules("remove");
        }
    });
    $body.on("change", "#d_fabrydisease, #d_f_fabrydisease", function () {
        if ($(this).val() !== "No") {
            $('#i_fabrydisease').rules("add", {
                required: true
            });
        } else {
            $('#i_fabrydisease').rules("remove");
        }
    });
    $body.on("change", "#d_factorv, #d_f_factorv", function () {
        if ($(this).val() !== "No") {
            $('#i_factorv').rules("add", {
                required: true
            });
        } else {
            $('#i_factorv').rules("remove");
        }
    });
    $body.on("change", "#d_familial, #d_f_familial", function () {
        if ($(this).val() !== "No") {
            $('#i_familial').rules("add", {
                required: true
            });
        } else {
            $('#i_familial').rules("remove");
        }
    });
    $body.on("change", "#d_familialfever, #d_f_familialfever", function () {
        if ($(this).val() !== "No") {
            $('#i_familialfever').rules("add", {
                required: true
            });
        } else {
            $('#i_familialfever').rules("remove");
        }
    });
    $body.on("change", "#d_fanconi, #d_f_fanconi", function () {
        if ($(this).val() !== "No") {
            $('#i_fanconi').rules("add", {
                required: true
            });
        } else {
            $('#i_fanconi').rules("remove");
        }
    });
    $body.on("change", "#d_hemophilia, #d_f_hemophilia", function () {
        if ($(this).val() !== "No") {
            $('#i_hemophilia').rules("add", {
                required: true
            });
        } else {
            $('#i_hemophilia').rules("remove");
        }
    });
    $body.on("change", "#d_marfan, #d_f_marfan", function () {
        if ($(this).val() !== "No") {
            $('#i_marfan').rules("add", {
                required: true
            });
        } else {
            $('#i_marfan').rules("remove");
        }
    });
    $body.on("change", "#d_mucolipidosis, #d_f_mucolipidosis", function () {
        if ($(this).val() !== "No") {
            $('#i_mucolipidosis').rules("add", {
                required: true
            });
        } else {
            $('#i_mucolipidosis').rules("remove");
        }
    });
    $body.on("change", "#d_niemann, #d_f_niemann", function () {
        if ($(this).val() !== "No") {
            $('#i_niemann').rules("add", {
                required: true
            });
        } else {
            $('#i_niemann').rules("remove");
        }
    });
    $body.on("change", "#d_sickle, #d_f_sickle", function () {
        if ($(this).val() !== "No") {
            $('#i_sickle').rules("add", {
                required: true
            });
        } else {
            $('#i_sickle').rules("remove");
        }
    });
    $body.on("change", "#d_taysachs, #d_f_taysachs", function () {
        if ($(this).val() !== "No") {
            $('#i_taysachs').rules("add", {
                required: true
            });
        } else {
            $('#i_taysachs').rules("remove");
        }
    });
    $body.on("change", "#d_thallasmia, #d_f_thallasmia", function () {
        if ($(this).val() !== "No") {
            $('#i_thallasmia').rules("add", {
                required: true
            });
        } else {
            $('#i_thallasmia').rules("remove");
        }
    });
    $body.on("change", "#d_blindness, #d_f_blindness", function () {
        if ($(this).val() !== "No") {
            $('#i_blindness').rules("add", {
                required: true
            });
        } else {
            $('#i_blindness').rules("remove");
        }
    });
    $body.on("change", "#d_colorblind, #d_f_colorblind", function () {
        if ($(this).val() !== "No") {
            $('#i_colorblind').rules("add", {
                required: true
            });
        } else {
            $('#i_colorblind').rules("remove");
        }
    });
    $body.on("change", "#d_deafness, #d_f_deafness", function () {
        if ($(this).val() !== "No") {
            $('#i_deafness').rules("add", {
                required: true
            });
        } else {
            $('#i_deafness').rules("remove");
        }
    });
    $body.on("change", "#d_albinism, #d_f_albinism", function () {
        if ($(this).val() !== "No") {
            $('#i_albinism').rules("add", {
                required: true
            });
        } else {
            $('#i_albinism').rules("remove");
        }
    });
    $body.on("change", "#d_muscular, #d_f_muscular", function () {
        if ($(this).val() !== "No") {
            $('#i_muscular').rules("add", {
                required: true
            });
        } else {
            $('#i_muscular').rules("remove");
        }
    });
    $body.on("change", "#d_galactosemia, #d_f_galactosemia", function () {
        if ($(this).val() !== "No") {
            $('#i_galactosemia').rules("add", {
                required: true
            });
        } else {
            $('#i_galactosemia').rules("remove");
        }
    });
    $body.on("change", "#d_hurler, #d_f_hurler", function () {
        if ($(this).val() !== "No") {
            $('#i_hurler').rules("add", {
                required: true
            });
        } else {
            $('#i_hurler').rules("remove");
        }
    });
    $body.on("change", "#d_other_genetic, #d_f_other_genetic", function () {
        if ($(this).val() !== "No") {
            $('#i_other_genetic').rules("add", {
                required: true
            });
        } else {
            $('#i_other_genetic').rules("remove");
        }
    });
    $body.on("change", "#d_breast_cancer, #d_f_breast_cancer", function () {
        if ($(this).val() !== "No") {
            $('#i_breast_cancer').rules("add", {
                required: true
            });
        } else {
            $('#i_breast_cancer').rules("remove");
        }
    });
    $body.on("change", "#d_colon_cancer, #d_f_colon_cancer", function () {
        if ($(this).val() !== "No") {
            $('#i_colon_cancer').rules("add", {
                required: true
            });
        } else {
            $('#i_colon_cancer').rules("remove");
        }
    });
    $body.on("change", "#d_hereditary_non, #d_f_hereditary_non", function () {
        if ($(this).val() !== "No") {
            $('#i_hereditary_non').rules("add", {
                required: true
            });
        } else {
            $('#i_hereditary_non').rules("remove");
        }
    });
    $body.on("change", "#d_ovarian_cancer, #d_f_ovarian_cancer", function () {
        if ($(this).val() !== "No") {
            $('#i_ovarian_cancer').rules("add", {
                required: true
            });
        } else {
            $('#i_ovarian_cancer').rules("remove");
        }
    });
    $body.on("change", "#d_any_other_cancer, #d_f_any_other_cancer", function () {
        if ($(this).val() !== "No") {
            $('#i_any_other_cancer').rules("add", {
                required: true
            });
        } else {
            $('#i_any_other_cancer').rules("remove");
        }
    });
    $body.on("change", "#d_alzheimer, #d_f_alzheimer", function () {
        if ($(this).val() !== "No") {
            $('#i_alzheimer').rules("add", {
                required: true
            });
        } else {
            $('#i_alzheimer').rules("remove");
        }
    });
    $body.on("change", "#d_autism, #d_f_autism", function () {
        if ($(this).val() !== "No") {
            $('#i_autism').rules("add", {
                required: true
            });
        } else {
            $('#i_autism').rules("remove");
        }
    });
    $body.on("change", "#d_cerebral, #d_f_cerebral", function () {
        if ($(this).val() !== "No") {
            $('#i_cerebral').rules("add", {
                required: true
            });
        } else {
            $('#i_cerebral').rules("remove");
        }
    });
    $body.on("change", "#d_creultzfeldt, #d_f_creultzfeldt", function () {
        if ($(this).val() !== "No") {
            $('#i_creultzfeldt').rules("add", {
                required: true
            });
        } else {
            $('#i_creultzfeldt').rules("remove");
        }
    });
    $body.on("change", "#d_depression, #d_f_depression", function () {
        if ($(this).val() !== "No") {
            $('#i_depression').rules("add", {
                required: true
            });
        } else {
            $('#i_depression').rules("remove");
        }
    });
    $body.on("change", "#d_gaucher, #d_f_gaucher", function () {
        if ($(this).val() !== "No") {
            $('#i_gaucher').rules("add", {
                required: true
            });
        } else {
            $('#i_gaucher').rules("remove");
        }
    });
    $body.on("change", "#d_huntington, #d_f_huntington", function () {
        if ($(this).val() !== "No") {
            $('#i_huntington').rules("add", {
                required: true
            });
        } else {
            $('#i_huntington').rules("remove");
        }
    });
    $body.on("change", "#d_hydrocephalus, #d_f_hydrocephalus", function () {
        if ($(this).val() !== "No") {
            $('#i_hydrocephalus').rules("add", {
                required: true
            });
        } else {
            $('#i_hydrocephalus').rules("remove");
        }
    });
    $body.on("change", "#d_obsessive_compulsive, #d_f_obsessive_compulsive", function () {
        if ($(this).val() !== "No") {
            $('#i_obsessive_compulsive').rules("add", {
                required: true
            });
        } else {
            $('#i_obsessive_compulsive').rules("remove");
        }
    });
    $body.on("change", "#d_mania, #d_f_mania", function () {
        if ($(this).val() !== "No") {
            $('#i_mania').rules("add", {
                required: true
            });
        } else {
            $('#i_mania').rules("remove");
        }
    });
    $body.on("change", "#d_neurofibro, #d_f_neurofibro", function () {
        if ($(this).val() !== "No") {
            $('#i_neurofibro').rules("add", {
                required: true
            });
        } else {
            $('#i_neurofibro').rules("remove");
        }
    });
    $body.on("change", "#d_schizo, #d_f_schizo", function () {
        if ($(this).val() !== "No") {
            $('#i_schizo').rules("add", {
                required: true
            });
        } else {
            $('#i_schizo').rules("remove");
        }
    });
    $body.on("change", "#d_tourette, #d_f_tourette", function () {
        if ($(this).val() !== "No") {
            $('#i_tourette').rules("add", {
                required: true
            });
        } else {
            $('#i_tourette').rules("remove");
        }
    });
    $body.on("change", "#d_tuberous, #d_f_tuberous", function () {
        if ($(this).val() !== "No") {
            $('#i_tuberous').rules("add", {
                required: true
            });
        } else {
            $('#i_tuberous').rules("remove");
        }
    });
    $body.on("change", "#d_wilson_disease, #d_f_wilson_disease", function () {
        if ($(this).val() !== "No") {
            $('#i_wilson_disease').rules("add", {
                required: true
            });
        } else {
            $('#i_wilson_disease').rules("remove");
        }
    });
    $body.on("change", "#d_multiple_sclerosis, #d_f_multiple_sclerosis", function () {
        if ($(this).val() !== "No") {
            $('#i_multiple_sclerosis').rules("add", {
                required: true
            });
        } else {
            $('#i_multiple_sclerosis').rules("remove");
        }
    });
    $body.on("change", "#d_parkinson, #d_f_parkinson", function () {
        if ($(this).val() !== "No") {
            $('#i_parkinson').rules("add", {
                required: true
            });
        } else {
            $('#i_parkinson').rules("remove");
        }
    });
    $body.on("change", "#d_lou_gehrig, #d_f_lou_gehrig", function () {
        if ($(this).val() !== "No") {
            $('#i_lou_gehrig').rules("add", {
                required: true
            });
        } else {
            $('#i_lou_gehrig').rules("remove");
        }
    });
    $body.on("change", "#d_any_other_neuro, #d_f_any_other_neuro", function () {
        if ($(this).val() !== "No") {
            $('#i_any_other_neuro').rules("add", {
                required: true
            });
        } else {
            $('#i_any_other_neuro').rules("remove");
        }
    });
    $body.on("change", "#d_diabetes, #d_f_diabetes", function () {
        if ($(this).val() !== "No") {
            $('#i_diabetes').rules("add", {
                required: true
            });
        } else {
            $('#i_diabetes').rules("remove");
        }
    });
    $body.on("change", "#d_heart_disease, #d_f_heart_disease", function () {
        if ($(this).val() !== "No") {
            $('#i_heart_disease').rules("add", {
                required: true
            });
        } else {
            $('#i_heart_disease').rules("remove");
        }
    });
    $body.on("change", "#d_high_blood, #d_f_high_blood", function () {
        if ($(this).val() !== "No") {
            $('#i_high_blood').rules("add", {
                required: true
            });
        } else {
            $('#i_high_blood').rules("remove");
        }
    });
    $body.on("change", "#d_asthma, #d_f_asthma", function () {
        if ($(this).val() !== "No") {
            $('#i_asthma').rules("add", {
                required: true
            });
        } else {
            $('#i_asthma').rules("remove");
        }
    });
    $body.on("change", "#d_lupus, #d_f_lupus", function () {
        if ($(this).val() !== "No") {
            $('#i_lupus').rules("add", {
                required: true
            });
        } else {
            $('#i_lupus').rules("remove");
        }
    });
    $body.on("change", "#d_obesity, #d_f_obesity", function () {
        if ($(this).val() !== "No") {
            $('#i_obesity').rules("add", {
                required: true
            });
        } else {
            $('#i_obesity').rules("remove");
        }
    });
    $body.on("change", "#d_alcoholism, #d_f_alcoholism", function () {
        if ($(this).val() !== "No") {
            $('#i_alcoholism').rules("add", {
                required: true
            });
        } else {
            $('#i_alcoholism').rules("remove");
        }
    });
    $body.on("change", "#d_infertility, #d_f_infertility", function () {
        if ($(this).val() !== "No") {
            $('#i_infertility').rules("add", {
                required: true
            });
        } else {
            $('#i_infertility').rules("remove");
        }
    });
    $body.on("change", "#d_recurrent, #d_f_recurrent", function () {
        if ($(this).val() !== "No") {
            $('#i_recurrent').rules("add", {
                required: true
            });
        } else {
            $('#i_recurrent').rules("remove");
        }
    });
    $body.on("change", "#d_endometriosis, #d_f_endometriosis", function () {
        if ($(this).val() !== "No") {
            $('#i_endometriosis').rules("add", {
                required: true
            });
        } else {
            $('#i_endometriosis').rules("remove");
        }
    });
    $body.on("change", "#d_polycystic_ovary, #d_f_polycystic_ovary", function () {
        if ($(this).val() !== "No") {
            $('#i_polycystic_ovary').rules("add", {
                required: true
            });
        } else {
            $('#i_polycystic_ovary').rules("remove");
        }
    });
    $body.on("change", "#d_uterine_fibroids, #d_f_uterine_fibroids", function () {
        if ($(this).val() !== "No") {
            $('#i_uterine_fibroids').rules("add", {
                required: true
            });
        } else {
            $('#i_uterine_fibroids').rules("remove");
        }
    });
    $('body').on('click', '#submit8', function (evt) {
        evt.preventDefault();

        var form = $('#step8');

        var isValid = form.valid();

        if (!isValid) {
            return 0;
        } else {
            form.submit();
        }
    });

//endregion

//region (STEP 8) Medical History Step 3 Information saving using Ajax Logic
    $('#step8').submit(function (evt) {
        evt.preventDefault();

        var form = $(this);
        var btn = $(this).find('button.donor-submit');

        //if validation fails stop form submission
        var isValid = $(this).valid();
        if (!isValid) return 0;

        showSpiner(btn);

        $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: form.serialize(),
            dataType: "json",
            success: function (response) {
                if (!response.error) {
                    $('#donor_q_next').click();
                    notify(response.message, response.title);
                } else {
                    notify(response.message, response.title);
                }
            },
            error: function (response) {

            },
            complete: function () {
                hideSpinner(btn);
            }
        });
    });
//endregion

//region (STEP 9) Medical History Information Validation
    validator = $('#step9').validate({
        rules: {
            aids: {
                required: true
            },
            herpes: {
                required: true
            },
            gonorrhea: {
                required: true
            },
            chlamydia: {
                required: true
            },
            condyloma: {
                required: true
            },
            syphilis: {
                required: true
            },
            pid: {
                required: true
            },
            hepb: {
                required: true
            },
            hepc: {
                required: true
            },
            tuberculosis: {
                required: true
            },
            medication_allergies: {
                required: true
            },
            latex_allergies: {
                required: true
            },
            previous_surgery: {
                required: true
            },
            emotional_problems: {
                required: true
            },
            psychologist: {
                required: true
            },
            anti_depressants: {
                required: true
            }
        },
    });

    $body.on("change", "#d_aids", function () {
        if ($(this).val() !== "No") {
            $('#i_aids').rules("add", {
                required: true
            });
        } else {
            $('#i_aids').rules("remove");
        }
    });
    $body.on("change", "#d_herpes", function () {
        if ($(this).val() !== "No") {
            $('#i_herpes').rules("add", {
                required: true
            });
        } else {
            $('#i_herpes').rules("remove");
        }
    });
    $body.on("change", "#d_gonorrhea", function () {
        if ($(this).val() !== "No") {
            $('#i_gonorrhea').rules("add", {
                required: true
            });
        } else {
            $('#i_gonorrhea').rules("remove");
        }
    });
    $body.on("change", "#d_chlamydia", function () {
        if ($(this).val() !== "No") {
            $('#i_chlamydia').rules("add", {
                required: true
            });
        } else {
            $('#i_chlamydia').rules("remove");
        }
    });
    $body.on("change", "#d_condyloma", function () {
        if ($(this).val() !== "No") {
            $('#i_condyloma').rules("add", {
                required: true
            });
        } else {
            $('#i_condyloma').rules("remove");
        }
    });
    $body.on("change", "#d_syphilis", function () {
        if ($(this).val() !== "No") {
            $('#i_syphilis').rules("add", {
                required: true
            });
        } else {
            $('#i_syphilis').rules("remove");
        }
    });
    $body.on("change", "#d_pid", function () {
        if ($(this).val() !== "No") {
            $('#i_pid').rules("add", {
                required: true
            });
        } else {
            $('#i_pid').rules("remove");
        }
    });
    $body.on("change", "#d_hepatitisB", function () {
        if ($(this).val() !== "No") {
            $('#i_hepatitisB').rules("add", {
                required: true
            });
        } else {
            $('#i_hepatitisB').rules("remove");
        }
    });
    $body.on("change", "#d_hepatitisC", function () {
        if ($(this).val() !== "No") {
            $('#i_hepatitisC').rules("add", {
                required: true
            });
        } else {
            $('#i_hepatitisC').rules("remove");
        }
    });
    $body.on("change", "#d_tuberculosis", function () {
        if ($(this).val() !== "No") {
            $('#i_tuberculosis').rules("add", {
                required: true
            });
        } else {
            $('#i_tuberculosis').rules("remove");
        }
    });
    $body.on("change", "#d_allergies", function () {
        if ($(this).val() !== "No") {
            $('#i_allergies').rules("add", {
                required: true
            });
        } else {
            $('#i_allergies').rules("remove");
        }
    });
    $body.on("change", "#d_allergiesLatex", function () {
        if ($(this).val() !== "No") {
            $('#i_allergiesLatex').rules("add", {
                required: true
            });
        } else {
            $('#i_allergiesLatex').rules("remove");
        }
    });
    $body.on("change", "#d_previousSurgery", function () {
        if ($(this).val() !== "No") {
            $('#i_previousSurgery').rules("add", {
                required: true
            });
        } else {
            $('#i_previousSurgery').rules("remove");
        }
    });

    $body.on("change", "#d_emotional, #d_psychologist, #d_antiAnxiety", function () {
        if ($(this).val() !== "No") {
            $('#if_y_p_e').rules("add", {
                required: true
            });
        } else {
            $('#if_y_p_e').rules("remove");
        }
    });

    $body.on('click', '#submit9', function (evt) {
        evt.preventDefault();

        $("#step10 input:file").each(function () {
            $(this).rules("add", {
                required: true,
                accept: "jpg|jpeg"
            });
        });

        var form = $('#step9');

        var isValid = form.valid();

        if (!isValid) {
            return 0;
        } else {
            form.submit();
        }
    });

//endregion

//region (STEP 9) Medical History Step 4 Information saving using Ajax Logic
    $('#step9').submit(function (evt) {
        evt.preventDefault();

        var form = $(this);
        var btn = $(this).find('button.donor-submit');

        //if validation fails stop form submission
        var isValid = $(this).valid();
        if (!isValid) return 0;

        showSpiner(btn);

        $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: form.serialize(),
            dataType: "json",
            success: function (response) {
                if (!response.error) {
                    $('#donor_q_next').click();
                    notify(response.message, response.title);
                } else {
                    notify(response.message, response.title);
                }
            },
            error: function (response) {

            },
            complete: function () {
                hideSpinner(btn);
            }
        });
    });
//endregion

//region (STEP 10) Donor Profile Information Validation
    $('#step10').validate({
        rules: {
            height: {
                required: true
            },
            weight: {
                required: true
            },
            race: {
                required: true
            },
            age: {
                required: true
            },
            mother: {
                required: true
            },
            mothers_mother: {
                required: true
            },
            mothers_father: {
                required: true
            },
            father: {
                required: true
            },
            fathers_mother: {
                required: true
            },
            fathers_father: {
                required: true
            },
            religion: {
                required: true
            },
            adopted: {
                required: true
            },
            weight_change: {
                required: true
            },
            dexterity: {
                required: true
            },
            bones: {
                required: true
            },
            complexion: {
                required: true
            },
            tan: {
                required: true
            },
            skin: {
                required: true
            },
            dimples: {
                required: true
            },
            eye_color: {
                required: true
            },
            eye_set: {
                required: true
            },
            eye_size: {
                required: true
            },
            eye_shape: {
                required: true
            },
            hair_color: {
                required: true
            },
            hair_type: {
                required: true
            },
            hair_texture: {
                required: true
            },
            hair_fullness: {
                required: true
            },
            baldness: {
                required: true
            },
            baldness_family: {
                required: true
            },
            graying: {
                required: true
            },
            body_facial_features: {
                required: true
            },
            teeth: {
                required: true
            },
            orthodontic_work: {
                required: true
            },
            hearing: {
                required: true
            },
            vision: {
                required: true
            },
            glasses: {
                required: true
            },
            stigmatism: {
                required: true
            },
            stigmatism_age: {
                required: true
            },
            photo_permission: {
                required: true
            },
        }
    });

    var form = $('#step10');
    $body.on("change", "#d_weight_gain_loss", function () {
        form.valid();
        if ($(this).val() !== "No") {
            $('#i_weight_gain_loss').rules("add", {
                required: true
            });

            form.valid();

        } else {
            $('#i_weight_gain_loss').rules("remove");
            form.valid();
        }
    });
    $body.on("change", "#d_prematureGraying", function () {

        form.valid();
        if ($(this).val() !== "No") {
            $('#i_prematureGraying').rules("add", {
                required: true
            });

            form.valid();
        } else {
            $('#i_prematureGraying').rules("remove");
            form.valid();
        }
    });
    $body.on("change", "#d_periodonalword", function () {
        form.valid();
        if ($(this).val() !== "No") {
            $('#i_periodonalword').rules("add", {
                required: true
            });
            form.valid();
        } else {
            $('#i_periodonalword').rules("remove");
            form.valid();
        }
    });
    $body.on("change", "#d_glassesCorrective", function () {
        form.valid();
        if ($(this).val() !== "No") {
            $('#i_glassesCorrective').rules("add", {
                required: true
            });
            form.valid();
        } else {
            $('#i_glassesCorrective').rules("remove");
            form.valid();
        }
    });
    $body.on("change", "#d_stigmatism", function () {
        form.valid();
        if ($(this).val() !== "No") {
            $('#i_stigmatism').rules("add", {
                required: true
            });
            form.valid();
        } else {
            $('#i_stigmatism').rules("remove");
            form.valid();
        }
    });

    //at least one donation reason checkbox should be checked on checkbox click
    $body.on('click', '.egg-donation-reason', function () {
        validateDonationReason();
    });

    $body.on('click', '#submit10', function (evt) {
        evt.preventDefault();

        var form = $('#step10');

        var isValid = form.valid();

        var response = validateDonationReason();

        if (isValid && response === 1) {
            form.submit();
        } else {
            return 0;
        }
    });
//endregion

//region (STEP 10) Donor Profile Information saving using Ajax Logic
    $('#step10').submit(function (evt) {
        evt.preventDefault();

        var form = $(this);
        var btn = $(this).find('button.donor-submit');

        var formData = new FormData(form[0]);

        //if validation fails stop form submission
        var isValid = $(this).valid();
        if (!isValid) return 0;

        showSpiner(btn);

        $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            data: formData,
            processData: false,
            contentType: false,
            success: function (response) {
                if (!response.error) {
                    notify(response.message, response.title);
                    $('#successfully').modal({
                        backdrop: 'static',
                        keyboard: false
                    });

                } else {
                    notify(response.message, response.title);
                }
            },
            error: function (response) {

            },
            complete: function () {
                hideSpinner(btn);

            }
        });
    });
//endregion
});
$('#successfully').on('hidden.bs.modal', function () {
    window.location.replace('/');
});

/**
 * @description If college is checked then check the graduate high school automatically,
 * validate them, and disable them
 * @return {boolean}
 */
function validateSchool() {
    if ($('#high-school input[type=checkbox]:checked').length > 0) {
        $('#high-school .custom-error').remove();
        return true;
    } else {
        $('#high-school').append('<label class="error custom-error" style="display: block;">Please choose at least one option.</label>');
        return false;
    }
}

/**
 * @desc At least one donation reason
 * checkbox should be checked
 */
function validateDonationReason() {
    var response = 0;
    if ($('.egg-donation-reason').is(':checked')) {
        $('#egg-donation-reason .custom-error').remove();
        response = 1;
    } else {
        $('#egg-donation-reason').append('<label class="error custom-error" style="display: block;">Please choose at least one option.</label>');
        response = 0;
    }
    return response;
}


/**
 * @desc At least one current sexual practice
 * checkbox should be checked
 */
function validateCSexualPractice() {
    var response = 0;
    if ($('.cb-current-sexual').is(':checked')) {
        $('#current .custom-error').remove();
        response = 1;
    } else {
        $('#current').append('<label class="error custom-error" style="display: block !important;">Please choose at least one option.</label>');
        response = 0;
    }
    return response;
}

/**
 * @desc At least one  previous sexual practice
 * checkbox should be checked
 */
function validatePSexualPractice() {
    var response = false;
    if ($('.cb-previous-sexual').is(':checked')) {
        $('#previous .custom-error').remove();
        response = 1;
    } else {
        $('#previous').append('<label class="error custom-error" style="display: block;">Please choose at least one option.</label>');
        response = 0;
    }
    return response;
}

/**
 * @desc If any of the college checkbox is checked then check and disable school checkbox
 *
 */
function validateCollege() {
    if ($('.college').is(':checked')) {
        $('.high-school').prop('checked', false).prop('disabled', true);
        $('.high-school:last').prop('checked', true);

        //hide the high school error when college is checked
        $('#high-school .custom-error').remove();
    }
    else {
        $('.high-school').attr('disabled', false);
    }
}

/**
 * @desc Scroll top to error if there is any error
 * @return {number}
 */
function scrollToError() {
    $('html, body').animate({
        scrollTop: ($('.error').offset().top - 300)
    }, 2000);
    return 0;
}

